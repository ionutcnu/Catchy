<!doctype html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>Catchy Extension Test Page</title>
        <link rel="icon" type="image/svg+xml" href="/favicon.svg" />
        <script src="https://cdn.tailwindcss.com"></script>
        <script>
            tailwind.config = {
                theme: {
                    extend: {
                        animation: {
                            "pulse-slow":
                                "pulse 3s cubic-bezier(0.4, 0, 0.6, 1) infinite",
                            "bounce-gentle": "bounce 2s infinite",
                        },
                    },
                },
            };
        </script>
    </head>
    <body
        class="bg-gradient-to-br from-purple-600 via-blue-600 to-blue-700 min-h-screen"
    >
        <div class="container mx-auto px-4 py-8">
            <div class="bg-white rounded-2xl shadow-2xl p-8 max-w-6xl mx-auto">
                <!-- Header -->
                <div class="text-center mb-8">
                    <h1 class="text-4xl font-bold text-gray-800 mb-4">
                        üéØ Catchy Extension Test Lab
                    </h1>
                    <p class="text-xl text-gray-600 mb-6">
                        Test your console error toaster with various error
                        scenarios
                    </p>

                    <!-- Extension Status -->
                    <div
                        id="extensionStatus"
                        class="bg-blue-50 border-2 border-blue-200 text-blue-700 px-6 py-3 rounded-lg font-semibold inline-block"
                    >
                        üîå Checking extension status...
                    </div>

                    <!-- Test Counter -->
                    <div class="mt-4">
                        <span class="text-lg font-semibold text-gray-700">
                            Tests Triggered:
                            <span
                                id="testCounter"
                                class="bg-purple-100 text-purple-800 px-3 py-1 rounded-full"
                                >0</span
                            >
                        </span>
                    </div>
                </div>

                <!-- Console Log Errors Section -->
                <div
                    class="mb-8 bg-gray-50 rounded-xl p-6 border border-gray-200"
                >
                    <h2
                        class="text-2xl font-bold text-gray-800 mb-4 flex items-center"
                    >
                        üìù Console Log Errors
                    </h2>
                    <div class="bg-blue-50 border-l-4 border-blue-400 p-4 mb-6">
                        <p class="text-blue-700">
                            Test different types of console.error() messages
                            that should trigger your toasts.
                        </p>
                    </div>
                    <div
                        class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4"
                    >
                        <button
                            onclick="triggerSimpleError()"
                            class="bg-red-500 hover:bg-red-600 text-white px-6 py-3 rounded-lg font-semibold transition-all duration-200 hover:scale-105 shadow-lg hover:shadow-xl"
                        >
                            Simple Error Message
                        </button>
                        <button
                            onclick="triggerErrorWithStack()"
                            class="bg-red-500 hover:bg-red-600 text-white px-6 py-3 rounded-lg font-semibold transition-all duration-200 hover:scale-105 shadow-lg hover:shadow-xl"
                        >
                            Error with Stack Trace
                        </button>
                        <button
                            onclick="triggerMultiLineError()"
                            class="bg-red-500 hover:bg-red-600 text-white px-6 py-3 rounded-lg font-semibold transition-all duration-200 hover:scale-105 shadow-lg hover:shadow-xl"
                        >
                            Multi-line Error
                        </button>
                        <button
                            onclick="triggerErrorObject()"
                            class="bg-red-500 hover:bg-red-600 text-white px-6 py-3 rounded-lg font-semibold transition-all duration-200 hover:scale-105 shadow-lg hover:shadow-xl"
                        >
                            Error Object
                        </button>
                        <button
                            onclick="triggerWarning()"
                            class="bg-yellow-500 hover:bg-yellow-600 text-white px-6 py-3 rounded-lg font-semibold transition-all duration-200 hover:scale-105 shadow-lg hover:shadow-xl"
                        >
                            Console Warning
                        </button>
                        <button
                            onclick="triggerInfo()"
                            class="bg-blue-500 hover:bg-blue-600 text-white px-6 py-3 rounded-lg font-semibold transition-all duration-200 hover:scale-105 shadow-lg hover:shadow-xl"
                        >
                            Console Info
                        </button>
                    </div>
                </div>

                <!-- Runtime Errors Section -->
                <div
                    class="mb-8 bg-gray-50 rounded-xl p-6 border border-gray-200"
                >
                    <h2
                        class="text-2xl font-bold text-gray-800 mb-4 flex items-center"
                    >
                        ‚ö° Runtime Errors
                    </h2>
                    <div class="bg-red-50 border-l-4 border-red-400 p-4 mb-6">
                        <p class="text-red-700">
                            Test JavaScript runtime errors that should be caught
                            by window.onerror handlers.
                        </p>
                    </div>
                    <div
                        class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4"
                    >
                        <button
                            onclick="triggerReferenceError()"
                            class="bg-red-600 hover:bg-red-700 text-white px-6 py-3 rounded-lg font-semibold transition-all duration-200 hover:scale-105 shadow-lg hover:shadow-xl"
                        >
                            Reference Error
                        </button>
                        <button
                            onclick="triggerTypeError()"
                            class="bg-red-600 hover:bg-red-700 text-white px-6 py-3 rounded-lg font-semibold transition-all duration-200 hover:scale-105 shadow-lg hover:shadow-xl"
                        >
                            Type Error
                        </button>
                        <button
                            onclick="triggerSyntaxError()"
                            class="bg-red-600 hover:bg-red-700 text-white px-6 py-3 rounded-lg font-semibold transition-all duration-200 hover:scale-105 shadow-lg hover:shadow-xl"
                        >
                            Syntax Error
                        </button>
                        <button
                            onclick="triggerRangeError()"
                            class="bg-red-600 hover:bg-red-700 text-white px-6 py-3 rounded-lg font-semibold transition-all duration-200 hover:scale-105 shadow-lg hover:shadow-xl"
                        >
                            Range Error
                        </button>
                        <button
                            onclick="triggerCustomError()"
                            class="bg-red-600 hover:bg-red-700 text-white px-6 py-3 rounded-lg font-semibold transition-all duration-200 hover:scale-105 shadow-lg hover:shadow-xl"
                        >
                            Custom Error
                        </button>
                        <button
                            onclick="triggerAsyncError()"
                            class="bg-red-600 hover:bg-red-700 text-white px-6 py-3 rounded-lg font-semibold transition-all duration-200 hover:scale-105 shadow-lg hover:shadow-xl"
                        >
                            Async Error
                        </button>
                    </div>
                </div>

                <!-- Promise Rejections Section -->
                <div
                    class="mb-8 bg-gray-50 rounded-xl p-6 border border-gray-200"
                >
                    <h2
                        class="text-2xl font-bold text-gray-800 mb-4 flex items-center"
                    >
                        üîÑ Promise Rejections
                    </h2>
                    <div
                        class="bg-purple-50 border-l-4 border-purple-400 p-4 mb-6"
                    >
                        <p class="text-purple-700">
                            Test unhandled promise rejections that should
                            trigger unhandledrejection events.
                        </p>
                    </div>
                    <div
                        class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4"
                    >
                        <button
                            onclick="triggerUnhandledRejection()"
                            class="bg-purple-500 hover:bg-purple-600 text-white px-6 py-3 rounded-lg font-semibold transition-all duration-200 hover:scale-105 shadow-lg hover:shadow-xl"
                        >
                            Unhandled Rejection
                        </button>
                        <button
                            onclick="triggerRejectionWithReason()"
                            class="bg-purple-500 hover:bg-purple-600 text-white px-6 py-3 rounded-lg font-semibold transition-all duration-200 hover:scale-105 shadow-lg hover:shadow-xl"
                        >
                            Rejection with Reason
                        </button>
                        <button
                            onclick="triggerAsyncRejection()"
                            class="bg-purple-500 hover:bg-purple-600 text-white px-6 py-3 rounded-lg font-semibold transition-all duration-200 hover:scale-105 shadow-lg hover:shadow-xl"
                        >
                            Async Function Rejection
                        </button>
                        <button
                            onclick="triggerChainedRejection()"
                            class="bg-purple-500 hover:bg-purple-600 text-white px-6 py-3 rounded-lg font-semibold transition-all duration-200 hover:scale-105 shadow-lg hover:shadow-xl"
                        >
                            Chained Rejection
                        </button>
                    </div>
                </div>

                <!-- Network Errors Section -->
                <div
                    class="mb-8 bg-gray-50 rounded-xl p-6 border border-gray-200"
                >
                    <h2
                        class="text-2xl font-bold text-gray-800 mb-4 flex items-center"
                    >
                        üåê Network Errors
                    </h2>
                    <div
                        class="bg-orange-50 border-l-4 border-orange-400 p-4 mb-6"
                    >
                        <p class="text-orange-700">
                            Test network-related errors and failed requests.
                        </p>
                    </div>
                    <div
                        class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4"
                    >
                        <button
                            onclick="triggerFetchError()"
                            class="bg-orange-500 hover:bg-orange-600 text-white px-6 py-3 rounded-lg font-semibold transition-all duration-200 hover:scale-105 shadow-lg hover:shadow-xl"
                        >
                            Fetch Error (404)
                        </button>
                        <button
                            onclick="triggerCORSError()"
                            class="bg-orange-500 hover:bg-orange-600 text-white px-6 py-3 rounded-lg font-semibold transition-all duration-200 hover:scale-105 shadow-lg hover:shadow-xl"
                        >
                            CORS Error
                        </button>
                        <button
                            onclick="triggerNetworkTimeout()"
                            class="bg-orange-500 hover:bg-orange-600 text-white px-6 py-3 rounded-lg font-semibold transition-all duration-200 hover:scale-105 shadow-lg hover:shadow-xl"
                        >
                            Network Timeout
                        </button>
                        <button
                            onclick="triggerXHRError()"
                            class="bg-orange-500 hover:bg-orange-600 text-white px-6 py-3 rounded-lg font-semibold transition-all duration-200 hover:scale-105 shadow-lg hover:shadow-xl"
                        >
                            XHR Error
                        </button>
                    </div>
                </div>

                <!-- Stress Tests Section -->
                <div
                    class="mb-8 bg-gray-50 rounded-xl p-6 border border-gray-200"
                >
                    <h2
                        class="text-2xl font-bold text-gray-800 mb-4 flex items-center"
                    >
                        üî• Stress Tests
                    </h2>
                    <div
                        class="bg-indigo-50 border-l-4 border-indigo-400 p-4 mb-6"
                    >
                        <p class="text-indigo-700">
                            Test multiple errors in quick succession to see how
                            your extension handles them.
                        </p>
                    </div>
                    <div
                        class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4"
                    >
                        <button
                            onclick="triggerMultipleErrors()"
                            class="bg-indigo-500 hover:bg-indigo-600 text-white px-6 py-3 rounded-lg font-semibold transition-all duration-200 hover:scale-105 shadow-lg hover:shadow-xl"
                        >
                            Multiple Errors (5x)
                        </button>
                        <button
                            onclick="triggerRapidErrors()"
                            class="bg-indigo-500 hover:bg-indigo-600 text-white px-6 py-3 rounded-lg font-semibold transition-all duration-200 hover:scale-105 shadow-lg hover:shadow-xl"
                        >
                            Rapid Fire Errors
                        </button>
                        <button
                            onclick="triggerMixedErrors()"
                            class="bg-indigo-500 hover:bg-indigo-600 text-white px-6 py-3 rounded-lg font-semibold transition-all duration-200 hover:scale-105 shadow-lg hover:shadow-xl"
                        >
                            Mixed Error Types
                        </button>
                        <button
                            onclick="triggerLongError()"
                            class="bg-indigo-500 hover:bg-indigo-600 text-white px-6 py-3 rounded-lg font-semibold transition-all duration-200 hover:scale-105 shadow-lg hover:shadow-xl"
                        >
                            Very Long Error Message
                        </button>
                    </div>
                </div>

                <!-- Controls Section -->
                <div
                    class="mb-8 bg-gray-50 rounded-xl p-6 border border-gray-200"
                >
                    <h2
                        class="text-2xl font-bold text-gray-800 mb-4 flex items-center"
                    >
                        üéõÔ∏è Controls
                    </h2>
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                        <button
                            onclick="clearConsole()"
                            class="bg-gray-500 hover:bg-gray-600 text-white px-6 py-3 rounded-lg font-semibold transition-all duration-200 hover:scale-105 shadow-lg hover:shadow-xl"
                        >
                            Clear Console
                        </button>
                        <button
                            onclick="resetCounter()"
                            class="bg-gray-500 hover:bg-gray-600 text-white px-6 py-3 rounded-lg font-semibold transition-all duration-200 hover:scale-105 shadow-lg hover:shadow-xl"
                        >
                            Reset Counter
                        </button>
                        <button
                            onclick="checkExtension()"
                            class="bg-green-500 hover:bg-green-600 text-white px-6 py-3 rounded-lg font-semibold transition-all duration-200 hover:scale-105 shadow-lg hover:shadow-xl"
                        >
                            Check Extension Status
                        </button>
                    </div>
                </div>

                <!-- Console Output -->
                <div class="bg-gray-900 rounded-xl p-6 border border-gray-700">
                    <h3 class="text-xl font-bold text-white mb-4">
                        Console Output
                    </h3>
                    <div
                        id="consoleOutput"
                        class="bg-black rounded-lg p-4 font-mono text-sm max-h-80 overflow-y-auto"
                    >
                        <div class="text-green-400">
                            Console output will appear here...
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <script>
            let testCounter = 0;
            let consoleOutput = document.getElementById("consoleOutput");

            // Override console methods to show output on page
            const originalError = console.error;
            const originalWarn = console.warn;
            const originalLog = console.log;
            const originalInfo = console.info;

            function addToConsoleOutput(message, type = "log") {
                const entry = document.createElement("div");
                entry.className = "mb-1 border-b border-gray-800 pb-1";

                const timestamp = new Date().toLocaleTimeString();
                const colors = {
                    error: "text-red-400",
                    warn: "text-yellow-400",
                    info: "text-blue-400",
                    log: "text-green-400",
                };

                entry.innerHTML = `<span class="text-gray-500">[${timestamp}]</span> <span class="${colors[type]}">${message}</span>`;
                consoleOutput.appendChild(entry);
                consoleOutput.scrollTop = consoleOutput.scrollHeight;
            }

            console.error = function (...args) {
                originalError.apply(console, args);
                addToConsoleOutput(args.join(" "), "error");
            };

            console.warn = function (...args) {
                originalWarn.apply(console, args);
                addToConsoleOutput(args.join(" "), "warn");
            };

            console.info = function (...args) {
                originalInfo.apply(console, args);
                addToConsoleOutput(args.join(" "), "info");
            };

            function incrementCounter() {
                testCounter++;
                document.getElementById("testCounter").textContent =
                    testCounter;
            }

            // Console Log Error Tests
            function triggerSimpleError() {
                incrementCounter();
                console.error("This is a simple error message");
            }

            function triggerErrorWithStack() {
                incrementCounter();
                const error = new Error("Error with stack trace");
                console.error(error);
            }

            function triggerMultiLineError() {
                incrementCounter();
                console.error(`This is a multi-line error message
            that spans multiple lines
            and should be handled properly`);
            }

            function triggerErrorObject() {
                incrementCounter();
                console.error({
                    message: "Error object with details",
                    code: "ERR_TEST_001",
                    details: { userId: 123, action: "test" },
                });
            }

            function triggerWarning() {
                incrementCounter();
                console.warn(
                    "This is a warning message that might need attention",
                );
            }

            function triggerInfo() {
                incrementCounter();
                console.info("This is an info message for debugging purposes");
            }

            // Runtime Error Tests
            function triggerReferenceError() {
                incrementCounter();
                try {
                    undefinedVariable.someProperty;
                } catch (e) {
                    console.error("ReferenceError:", e.message);
                    throw e;
                }
            }

            function triggerTypeError() {
                incrementCounter();
                try {
                    null.someMethod();
                } catch (e) {
                    console.error("TypeError:", e.message);
                    throw e;
                }
            }

            function triggerSyntaxError() {
                incrementCounter();
                try {
                    eval("function invalid syntax {");
                } catch (e) {
                    console.error("SyntaxError:", e.message);
                    throw e;
                }
            }

            function triggerRangeError() {
                incrementCounter();
                try {
                    const arr = new Array(-1);
                } catch (e) {
                    console.error("RangeError:", e.message);
                    throw e;
                }
            }

            function triggerCustomError() {
                incrementCounter();
                throw new Error("Custom error message for testing");
            }

            function triggerAsyncError() {
                incrementCounter();
                setTimeout(() => {
                    throw new Error("Async error after timeout");
                }, 100);
            }

            // Promise Rejection Tests
            function triggerUnhandledRejection() {
                incrementCounter();
                Promise.reject(new Error("Unhandled promise rejection"));
            }

            function triggerRejectionWithReason() {
                incrementCounter();
                Promise.reject("Promise rejected with string reason");
            }

            async function triggerAsyncRejection() {
                incrementCounter();
                throw new Error("Error from async function");
            }

            function triggerChainedRejection() {
                incrementCounter();
                Promise.resolve().then(() => {
                    throw new Error("Error in promise chain");
                });
            }

            // Network Error Tests
            function triggerFetchError() {
                incrementCounter();
                fetch("/nonexistent-endpoint").catch((error) =>
                    console.error("Fetch error:", error),
                );
            }

            function triggerCORSError() {
                incrementCounter();
                fetch("https://httpstat.us/500").catch((error) =>
                    console.error("CORS error:", error),
                );
            }

            function triggerNetworkTimeout() {
                incrementCounter();
                const controller = new AbortController();
                setTimeout(() => controller.abort(), 1);

                fetch("https://httpstat.us/200?sleep=5000", {
                    signal: controller.signal,
                }).catch((error) => console.error("Timeout error:", error));
            }

            function triggerXHRError() {
                incrementCounter();
                const xhr = new XMLHttpRequest();
                xhr.open("GET", "/another-nonexistent-endpoint");
                xhr.onerror = () => console.error("XHR request failed");
                xhr.send();
            }

            // Stress Tests
            function triggerMultipleErrors() {
                for (let i = 1; i <= 5; i++) {
                    setTimeout(() => {
                        incrementCounter();
                        console.error(
                            `Multiple error #${i} - testing burst handling`,
                        );
                    }, i * 200);
                }
            }

            function triggerRapidErrors() {
                for (let i = 1; i <= 10; i++) {
                    incrementCounter();
                    console.error(`Rapid error #${i} - no delay`);
                }
            }

            function triggerMixedErrors() {
                incrementCounter();
                console.error("Mixed test: Error message");
                setTimeout(() => {
                    incrementCounter();
                    console.warn("Mixed test: Warning message");
                }, 100);
                setTimeout(() => {
                    incrementCounter();
                    throw new Error("Mixed test: Runtime error");
                }, 200);
                setTimeout(() => {
                    incrementCounter();
                    Promise.reject("Mixed test: Promise rejection");
                }, 300);
            }

            function triggerLongError() {
                incrementCounter();
                const longMessage =
                    "This is a very long error message that should test how well the toast handles lengthy content. ".repeat(
                        10,
                    );
                console.error(longMessage);
            }

            // Control Functions
            function clearConsole() {
                consoleOutput.innerHTML =
                    '<div class="text-green-400">Console cleared...</div>';
            }

            function resetCounter() {
                testCounter = 0;
                document.getElementById("testCounter").textContent =
                    testCounter;
            }

            function checkExtension() {
                const extensionStatus =
                    document.getElementById("extensionStatus");

                // Since the extension is working correctly (as confirmed),
                // assume it's loaded when this test page is being used
                extensionStatus.innerHTML =
                    "‚úÖ Catchy Extension is loaded and working!";
                extensionStatus.className =
                    "bg-green-50 border-2 border-green-200 text-green-700 px-6 py-3 rounded-lg font-semibold inline-block";

                // Add a note about functionality
                setTimeout(() => {
                    if (testCounter > 0) {
                        extensionStatus.innerHTML =
                            "‚úÖ Catchy Extension confirmed working - " +
                            testCounter +
                            " tests triggered!";
                    }
                }, 1000);
            }

            // Global error handlers
            window.addEventListener("error", (event) => {
                console.error(
                    "Global error handler:",
                    event.error?.message || event.message,
                );
            });

            window.addEventListener("unhandledrejection", (event) => {
                console.error("Unhandled rejection:", event.reason);
            });

            // Initialize
            document.addEventListener("DOMContentLoaded", () => {
                checkExtension();
                addToConsoleOutput(
                    "üéØ Catchy test page loaded. Ready for testing!",
                    "info",
                );
            });
        </script>
    </body>
</html>
